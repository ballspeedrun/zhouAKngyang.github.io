<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
		<link rel="shortcut icon" type="image/ico" href="./zky.ico"/>
		<title>膜拜 zhouAKngyang</title>
	</head>
	<body>
		<style>
			#global{
				position: fixed;
				left:0;
				top:0;
				width: 100%;
				height: 100%;
				pointer-events:none;
				z-index: 1;
			}
		</style>
		<div id="app"></div>
		<script>
			{
				'use strict';
				const VERSION='0.6.4.2';
				const LOCAL=window.location.hostname.includes('localhost');
				Object.defineProperty(window,'LOCAL',{get:()=>LOCAL});
				function toAbsLoc(loc){
					let a=document.createElement('a');
					a.href=loc;
					return a.href;
				}
				function loadTag(url){
					return {
						get text(){
						},
						set text(newText){
						},
						done(){
						},
						failed(){
						},
						remove(){
						},
					};
				}
				async function loadByElement(tagName,defaultAttr,attrName,urls){
					urls=urls.map(toAbsLoc);
					for(let url of urls){
						let element=document.createElement(tagName);
						for(let name in defaultAttr){
							element.setAttribute(name,defaultAttr[name]);
						}
						element.setAttribute(attrName,url);
						let handler=loadTag(url);
						try{
							await new Promise((resolve,reject)=>{
								element.addEventListener('load',resolve);
								element.addEventListener('error',reject);
								document.body.appendChild(element);
							});
							handler.done();
							return url;
						}
						catch(_){
							handler.failed();
							document.body.removeChild(element);
						}
						first=false;
					}
					throw `load failed:\n${urls.join('\n')}`;
				}
				function loadScript(urls){
					return loadByElement('script',{},'src',urls);
				}
				function loadCSS(urls){
					return loadByElement('link',{rel:'stylesheet'},'href',urls);
				}
				async function loadText(urls){
					urls=urls.map(toAbsLoc);
					for(let url of urls){
							let handler=loadTag(url);
							try{
							let result=(await axios.get(url)).data;
							handler.done();
							return result;
						}
						catch(e){
							handler.failed();
							continue;
						}
					}
					throw `load failed:\n${urls.join('\n')}`;
				}
				Promise.all([
					Promise.all([
						LOCAL
							?loadScript(['https://zhouakngyang.github.io/orzzky1.js'])
							:loadScript(['https://zhouakngyang.github.io/orzzky2.js']),
						loadScript(['https://zhouakngyang.github.io/orzzky3.js'])
						.then(
							()=>Promise.all([
								loadText(['https://zhouakngyang.github.io/main.html']).then((result)=>{window.GAME_UI=result;}),
							])
						),
					])
					.then(()=>loadScript([`https://zhouakngyang.github.io/orzzky4.js`])),
					loadCSS(['https://zhouakngyang.github.io/orzzky1.css']),
					loadCSS(['https://zhouakngyang.github.io/orzzky2.css']),
					loadCSS(['https://zhouakngyang.github.io/orzzky3.css']),
				])
				.then(()=>{
				});
			}
		</script>
	</body>
</html>